version: '3.8'

services:
  music-upload:
    build: .
    container_name: music_upload_service
    restart: unless-stopped
    ports:
      - "8080:8080"
    volumes:
      # Mount Navidrome music directory
      - /srv/navidrome/music:/srv/navidrome/music
      # Mount temp directory for processing
      - /srv/navidrome/music/tmp:/srv/navidrome/music/tmp
      # Mount configuration
      - ./config.toml:/app/config.toml:ro
      # Mount data directory for SQLite database
      - ./data:/app/data
    environment:
      - RUST_LOG=info
      - CONFIG_PATH=/app/config.toml
    networks:
      - shared_web

networks:
  shared_web:
    external: true
    name: shared_web
