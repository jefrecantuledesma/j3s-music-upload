version: '3.8'

services:
  music-upload:
    build: .
    container_name: music_upload_service
    restart: unless-stopped
    # IMPORTANT: No ports exposed by default for security
    # Only accessible via reverse proxy (Caddy/Nginx)
    # To expose directly, uncomment: ports: - "8080:8080"
    volumes:
      # Mount Navidrome music directory
      - /srv/navidrome/music:/srv/navidrome/music
      # Mount temp directory for processing
      - /srv/navidrome/music/tmp:/srv/navidrome/music/tmp
      # Mount configuration
      - ./config.toml:/app/config.toml:ro
      # Mount data directory for SQLite database
      - ./data:/app/data
    environment:
      - RUST_LOG=info
      - CONFIG_PATH=/app/config.toml
    networks:
      - media_stack_internal

networks:
  media_stack_internal:
    external: true
    # Using the same network as media_stack services (Caddy, Navidrome, etc.)
